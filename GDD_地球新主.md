# 地球新主 - 游戏设计文档（GDD）

**版本：** 1.0
**日期：** 2025-12-23
**游戏名称：** 地球新主（EarthLord）
**游戏类型：** LBS生存策略游戏
**平台：** iOS

---

## 1. 游戏概念

### 1.1 一句话描述
用双脚丈量废土，圈占属于你的新世界。

### 1.2 电梯演讲
《地球新主》是一款结合真实地理位置的末日生存游戏。在2051年的废土世界中，玩家通过真实行走来圈占领地、探索废墟搜刮资源、建造设施发展势力，并与其他幸存者交易合作。这是"宝可梦GO"与"饥荒"的结合——用脚步开拓，用智慧生存。

### 1.3 游戏支柱（Design Pillars）
1. **真实探索：** 真实世界就是游戏地图
2. **生存压力：** 持续的资源消耗创造紧迫感
3. **领地建设：** 从无到有建造自己的末世家园
4. **社交协作：** 玩家之间的交易与通讯

---

## 2. 世界观设定

### 2.1 时间线
```
2048年 ─── "终末战争"爆发
           │
           ├── 全球文明在72小时内崩塌
           │
           └── 99%的人口消失

2051年 ─── 幸存者从废墟中走出
           │
           ├── 旧世界秩序不复存在
           │
           └──《新开拓者协议》颁布
```

### 2.2 核心法则
> **"凡以双足丈量之无主土地，皆为开拓者所有。"**
> —— 《新开拓者协议》第一条

这条法则是整个游戏的核心机制来源：
- 用GPS记录玩家的真实移动轨迹
- 围成闭合区域即可声明领地所有权
- 先到先得，不可重叠

### 2.3 视觉风格：希望朋克（Hopepunk）
**关键视觉元素：**
| 元素 | 描述 |
|------|------|
| 废土 | 破败的建筑、废弃的车辆、裂开的道路 |
| 新生 | 绿色植物破土而出、新建的木质建筑 |
| 色调 | 暖色调为主（橙、黄、绿），象征希望 |
| 符号 | 新芽、火焰、太阳等新生意象 |

**与其他末日风格的区别：**
| 风格 | 情绪 | 色调 |
|------|------|------|
| 废土朋克 | 绝望、黑暗 | 灰、褐、暗 |
| 希望朋克 | 希望、重建 | 绿、橙、暖 |

### 2.4 世界观要素

#### 开拓者（玩家角色）
- 终末战争的幸存者
- 从避难所苏醒
- 接受《新开拓者协议》成为合法开拓者
- 目标：重建文明、建造家园

#### 废墟（POI地点）
旧世界留下的建筑遗址，是资源的主要来源：
- 医院废墟 → 药品
- 超市废墟 → 食物
- 工厂废墟 → 金属
- 公园废墟 → 木材

#### 通讯设备
旧世界的无线电技术被保留下来：
- 收音机 → 接收广播
- 对讲机 → 近距离通讯
- 营地电台 → 中距离通讯
- 卫星通讯 → 全球联络

---

## 3. 核心游戏循环

### 3.1 主循环图
```
┌──────────────────────────────────────────────────────────┐
│                    核心游戏循环                            │
├──────────────────────────────────────────────────────────┤
│                                                          │
│    ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐            │
│    │登录  │───→│圈地  │───→│探索  │───→│资源  │            │
│    └─────┘    └─────┘    └─────┘    └──┬──┘            │
│                                        │                │
│                          ┌─────────────┼─────────────┐  │
│                          ↓             ↓             ↓  │
│                     ┌─────┐       ┌─────┐       ┌─────┐│
│                     │建造  │       │交易  │       │消耗  ││
│                     │消耗  │       │流通  │       │生存  ││
│                     └──┬──┘       └──┬──┘       └──┬──┘│
│                        │             │             │    │
│                        └─────────────┴─────────────┘    │
│                                    │                    │
│                                    ↓                    │
│    ┌─────┐    ┌─────┐    ┌─────┐                       │
│    │成长  │←───│成就  │←───│发展  │                       │
│    └─────┘    └─────┘    └─────┘                       │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 3.2 循环阶段说明

| 阶段 | 玩家行为 | 游戏反馈 | 心理满足 |
|------|----------|----------|----------|
| 圈地 | 真实行走绘制边界 | 领地确认动画 | 所有权、成就感 |
| 探索 | 接近真实地标 | 发现提示、搜刮动画 | 惊喜、收获感 |
| 资源 | 收集物资入背包 | 物品获得弹窗 | 积累感 |
| 建造 | 选择建筑消耗资源 | 建造进度、完成动画 | 创造感 |
| 消耗 | 体征自动衰减 | 饥饿/口渴警告 | 紧迫感 |
| 成长 | 完成成就/登榜 | 徽章解锁、排名上升 | 荣誉感 |

### 3.3 日常游戏节奏

**理想日常游戏流程：**
```
早晨出门
    ↓
检查生存体征 → 需要食物/水
    ↓
规划探索路线 → 选择有超市/餐厅的方向
    ↓
行走探索 → 沿途搜刮POI获取资源
    ↓
补充体征 → 使用罐头/饮用水
    ↓
圈占新地 → 发现无主区域圈地
    ↓
返回领地 → 使用资源建造/升级建筑
    ↓
社交互动 → 查看交易市场、公共频道
    ↓
下线前 → 确保体征>50%，避免离线死亡
```

---

## 4. 核心系统设计

### 4.1 圈地系统

#### 4.1.1 圈地规则
| 规则 | 说明 |
|------|------|
| 最小面积 | 100平方米 |
| 最大面积 | 50,000平方米（普通玩家） |
| 闭合距离 | 起点20米范围内 |
| 重叠检测 | 不允许与他人领地重叠 |
| 活跃要求 | 30天内须访问，90天须有建筑 |

#### 4.1.2 圈地流程状态机
```
待机 ──点击开始──→ 记录中 ──靠近起点──→ 闭合确认
                     │                    │
                     ↓                    ↓
                 取消/超时              验证中
                     │                    │
                     ↓                    ↓
                  待机  ←─失败─  验证结果 ─成功─→ 领地创建
```

#### 4.1.3 反作弊机制
| 作弊类型 | 检测方法 | 处理方式 |
|----------|----------|----------|
| GPS欺骗 | 速度异常检测（>50km/h） | 拒绝记录 |
| 位置跳跃 | 相邻点距离检测（>100m/s） | 轨迹无效 |
| 模拟器 | 设备指纹检测 | 账号警告 |

### 4.2 探索与搜刮系统

#### 4.2.1 POI类型与产出
| POI类型 | 对应真实地点 | 产出资源 | 产出数量 |
|---------|--------------|----------|----------|
| 医疗设施 | 医院、药店、诊所 | 药品、急救包 | 5-15 |
| 食品场所 | 超市、餐厅、便利店 | 罐头、饮用水 | 10-25 |
| 工业设施 | 工厂、工地、汽修店 | 金属、零件 | 8-20 |
| 自然场所 | 公园、林地、花园 | 木材、植物 | 10-30 |
| 特殊场所 | 银行、珠宝店 | 稀有材料 | 1-5 |

#### 4.2.2 搜刮机制
```
玩家接近POI（50米范围）
          ↓
     显示"发现"提示
          ↓
     点击"搜刮"按钮
          ↓
    ┌─────┴─────┐
    ↓           ↓
检查冷却CD    CD未到
    ↓           ↓
  可搜刮      显示剩余时间
    ↓
  播放动画
    ↓
根据POI类型随机生成物品
    ↓
  物品入背包
    ↓
  开始24小时CD
```

#### 4.2.3 探索成就记录
每次探索记录：
- 探索距离（km）
- 探索时长（min）
- 获得物品列表
- 发现POI数量

### 4.3 生存体征系统

#### 4.3.1 体征指标
| 指标 | 满值 | 衰减速率 | 危险阈值 | 死亡阈值 |
|------|------|----------|----------|----------|
| 核心生命 | 100 | 不衰减 | 30 | 0 |
| 饱食度 | 100% | -5%/小时 | 20% | - |
| 水分 | 100% | -10%/小时 | 20% | - |

#### 4.3.2 体征影响
```
┌─────────────────────────────────────────────────────┐
│                    体征影响表                         │
├──────────────┬──────────────────────────────────────┤
│  饱食度/水分  │            效果                       │
├──────────────┼──────────────────────────────────────┤
│    > 80%     │ 获得增益：探索距离+20%、资源产出+10%    │
│   50%-80%    │ 正常状态                              │
│   20%-50%    │ 轻度debuff：移动速度-10%              │
│    < 20%     │ 核心生命开始衰减（-5/小时）             │
│    = 0%      │ 核心生命加速衰减（-10/小时）            │
└──────────────┴──────────────────────────────────────┘
```

#### 4.3.3 恢复物品
| 物品 | 恢复效果 | 获取途径 |
|------|----------|----------|
| 罐头食品 | 饱食度+20% | 超市搜刮 |
| 饮用水 | 水分+25% | 超市搜刮 |
| 急救包 | 生命+20 | 医院搜刮 |
| 营养餐 | 饱食度+40%、水分+20% | 制作/购买 |

### 4.4 建造系统

#### 4.4.1 建筑等级体系
```
Tier 1 (生存基础)
    │
    ├── 篝火：取暖、烹饪
    ├── 帐篷：临时庇护
    └── 储水桶：储存水源

Tier 2 (功能扩展)
    │
    ├── 庇护所：永久住所
    ├── 仓库：扩展背包容量
    └── 农田：生产食物

Tier 3 (高级设施)
    │
    ├── 太阳能板：能源供应
    ├── 工作台：制作高级物品
    └── 营地电台：扩展通讯范围
```

#### 4.4.2 建筑配方表
| 建筑 | 木材 | 石头 | 金属 | 稀有材料 | 建造时间 |
|------|------|------|------|----------|----------|
| 篝火 | 30 | 20 | - | - | 5分钟 |
| 帐篷 | 50 | - | 10 | - | 15分钟 |
| 庇护所 | 100 | 80 | 30 | - | 1小时 |
| 小仓库 | 60 | 40 | 20 | - | 30分钟 |
| 中仓库 | 120 | 80 | 50 | 5 | 2小时 |
| 农田 | 40 | 20 | 10 | - | 20分钟 |
| 工作台 | 50 | 30 | 40 | 10 | 1小时 |
| 太阳能板 | - | - | 100 | 30 | 3小时 |
| 营地电台 | 30 | 20 | 80 | 50 | 4小时 |

#### 4.4.3 建筑状态机
```
          建造资源扣除
               ↓
┌─────┐     ┌─────┐     ┌─────┐
│建造中│────→│待激活│────→│运行中│
└─────┘     └─────┘     └──┬──┘
   ↑                       │
   │                       ↓ 损坏事件
   │        ┌─────┐     ┌─────┐
   └────────│拆除  │←────│损坏  │
            └─────┘     └─────┘
                           │
                           ↓ 维修
                        ┌─────┐
                        │运行中│
                        └─────┘
```

### 4.5 交易系统

#### 4.5.1 交易流程
```
卖家发布挂单
（我提供：罐头×10，我需要：药品×5）
          ↓
     挂单进入市场
          ↓
买家进入卖家领地100米范围
          ↓
     发现挂单列表
          ↓
买家选择接受交易
          ↓
    ┌─────┴─────┐
    ↓           ↓
检查双方物品    物品不足
    ↓           ↓
 交易成功      交易失败
    ↓
物品互换完成
```

#### 4.5.2 交易规则
| 规则 | 说明 |
|------|------|
| 触发距离 | 100米范围内 |
| 挂单上限 | 每人最多10个挂单 |
| 挂单有效期 | 7天自动过期 |
| 手续费 | 无（以物易物） |

### 4.6 通讯系统

#### 4.6.1 设备能力对照表
| 设备 | 收听 | 发送 | 公共频道 | 私人频道 | 范围 |
|------|------|------|----------|----------|------|
| 收音机 | ○ | × | ○ | × | - |
| 对讲机 | ○ | ○ | ○ | ○ | 3km |
| 营地电台 | ○ | ○ | ○ | ○ | 10km |
| 卫星通讯 | ○ | ○ | ○ | ○ | 全球 |

#### 4.6.2 频道类型
| 频道类型 | 说明 | 范围限制 |
|----------|------|----------|
| 公共频道 | 所有人可见 | 设备范围内 |
| 私人频道 | 加入者可见 | 设备范围内 |
| 系统广播 | 官方消息 | 全局 |

---

## 5. 经济系统设计

### 5.1 资源循环图
```
┌──────────────────────────────────────────────────────────┐
│                     资源循环                              │
├──────────────────────────────────────────────────────────┤
│                                                          │
│   探索产出                                                │
│   ┌───┐  ┌───┐  ┌───┐  ┌───┐  ┌───┐                    │
│   │食物│  │水源│  │木材│  │金属│  │稀有│                    │
│   └─┬─┘  └─┬─┘  └─┬─┘  └─┬─┘  └─┬─┘                    │
│     │      │      │      │      │                        │
│     └──────┴──────┴──────┴──────┘                        │
│                    ↓                                     │
│              ┌─────────┐                                 │
│              │  背 包  │                                 │
│              └────┬────┘                                 │
│                   │                                      │
│     ┌─────────────┼─────────────┐                        │
│     ↓             ↓             ↓                        │
│ ┌───────┐   ┌───────┐   ┌───────┐                       │
│ │生存消耗│   │建造消耗│   │交易流通│                       │
│ └───────┘   └───────┘   └───────┘                       │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 5.2 资源稀有度
| 稀有度 | 资源类型 | 获取难度 | 用途 |
|--------|----------|----------|------|
| 普通 | 木材、石头 | 容易 | 基础建筑 |
| 稀有 | 金属、布料 | 中等 | 中级建筑 |
| 史诗 | 电子元件、燃料 | 困难 | 高级建筑 |
| 传说 | 卫星模块 | 极难 | 终极建筑 |

### 5.3 资源消耗与产出平衡

**日均消耗预估（活跃玩家）：**
- 饱食度消耗：约120%（24小时 × 5%/小时）
- 水分消耗：约240%（24小时 × 10%/小时）
- 需补充：食物×6、水×10

**日均产出预估（活跃30分钟）：**
- 探索距离：约2-3km
- POI发现：约3-5个
- 资源产出：约30-80单位

**平衡策略：**
- 保证活跃玩家能自给自足
- 轻度玩家需要策略性选择
- 重度玩家有盈余可交易

---

## 6. 成长与激励系统

### 6.1 成就系统

#### 6.1.1 成就分类
| 分类 | 目的 | 示例 |
|------|------|------|
| 新手成就 | 引导基础功能 | 完成第一次圈地 |
| 探索成就 | 鼓励外出 | 累计探索10km |
| 建造成就 | 推动发展 | 建造10个建筑 |
| 社交成就 | 促进互动 | 完成首次交易 |
| 收集成就 | 增加粘性 | 收集所有资源类型 |
| 传说成就 | 终极目标 | 领地面积达100万㎡ |

#### 6.1.2 成就稀有度与奖励
| 稀有度 | 完成难度 | 金币奖励 | 示例 |
|--------|----------|----------|------|
| 普通 | 1小时内 | 50 | 首次登录 |
| 稀有 | 1天内 | 200 | 圈占首块领地 |
| 史诗 | 1周内 | 500 | 建造10个建筑 |
| 传说 | 1月+ | 2000 | 领地总面积1km² |

#### 6.1.3 EventBus架构
```
┌──────────────────────────────────────────────────────────┐
│                   事件发布-订阅架构                         │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  事件发布者                    事件订阅者                    │
│  ┌──────────┐               ┌──────────┐                │
│  │ 圈地系统  │───发布事件───→│ 成就系统  │                │
│  └──────────┘      │        └──────────┘                │
│  ┌──────────┐      │        ┌──────────┐                │
│  │ 探索系统  │───────┼───────→│ 统计系统  │                │
│  └──────────┘      │        └──────────┘                │
│  ┌──────────┐      │        ┌──────────┐                │
│  │ 建造系统  │───────┴───────→│ 排行榜   │                 │
│  └──────────┘               └──────────┘                │
│                                                          │
│  事件类型：圈地完成、探索完成、建造完成、交易完成...           │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 6.2 排行榜系统

#### 6.2.1 榜单类型
| 榜单 | 排名依据 | 刷新频率 |
|------|----------|----------|
| 领地面积榜 | 总领地面积 | 5分钟 |
| 探索废墟榜 | 累计探索距离 | 5分钟 |
| 建筑数量榜 | 建筑总数 | 5分钟 |

#### 6.2.2 排名奖励
| 排名 | 每日奖励 |
|------|----------|
| TOP 1 | 金币×500 |
| TOP 2-3 | 金币×300 |
| TOP 4-10 | 金币×100 |
| TOP 11-50 | 金币×50 |

---

## 7. 商业化设计

### 7.1 付费策略
采用"免费+内购"模式（F2P with IAP）

### 7.2 付费点设计

#### 7.2.1 订阅制（核心收入）
| 订阅 | 价格 | 核心权益 |
|------|------|----------|
| 开拓者月卡 | $9.99/月 | 探索范围+50%、每日资源包 |
| 领主通行证 | $19.99/月 | 所有特权、专属建筑皮肤 |

#### 7.2.2 一次性购买（冲动消费）
| 商品 | 价格 | 内容 |
|------|------|------|
| 初级物资包 | $0.99 | 随机资源×30 |
| 中级物资包 | $2.99 | 随机资源×100 + 稀有×5 |
| 高级物资包 | $9.99 | 随机资源×300 + 史诗×10 |
| 生存补给 | $4.99 | 食物×50 + 水×50 |

#### 7.2.3 设备升级（功能解锁）
| 设备 | 解锁方式 |
|------|----------|
| 收音机 | 免费 |
| 对讲机 | 游戏内资源制作 或 $2.99 |
| 营地电台 | 游戏内资源制作 或 $9.99 |
| 卫星通讯 | 仅限订阅用户 |

### 7.3 付费平衡原则
1. **免费可玩：** 不付费也能体验完整游戏
2. **付费加速：** 付费节省时间，不破坏平衡
3. **无P2W：** 付费不直接增强战斗力
4. **社交驱动：** 通讯设备差异促进升级欲望

---

## 8. 用户引导设计

### 8.1 新手任务链
```
任务1：身份登记
  ├── 目标：完成登录
  ├── 奖励：100金币
  └── 解锁：圈地功能

任务2：第一块领地
  ├── 目标：完成首次圈地
  ├── 奖励：木材×50、石头×50
  └── 解锁：探索功能

任务3：废墟搜刮
  ├── 目标：搜刮1个POI
  ├── 奖励：背包扩容+10
  └── 解锁：建造功能

任务4：点燃希望
  ├── 目标：建造第一个篝火
  ├── 奖励：200金币
  └── 解锁：交易功能

任务5：幸存者网络
  ├── 目标：发送第一条消息
  ├── 奖励：对讲机图纸
  └── 解锁：频道功能
```

### 8.2 回流机制
| 离线时长 | 回流奖励 |
|----------|----------|
| 1-3天 | 欢迎回来礼包（基础资源） |
| 3-7天 | 生存补给包（食物+水） |
| 7-14天 | 重建礼包（资源+金币） |
| 14天+ | 新开拓者礼包（完整新手奖励） |

---

## 9. 技术实现要点

### 9.1 核心技术选型
| 功能 | 技术方案 | 选择理由 |
|------|----------|----------|
| 地图 | Apple MapKit | 免费、全球可用 |
| 定位 | CoreLocation | 原生高精度 |
| 地理数据 | PostGIS | 多边形存储与查询 |
| 实时通讯 | Supabase Realtime | 开箱即用 |
| 用户认证 | Supabase Auth | OAuth集成 |
| 支付 | StoreKit 2 | 苹果原生 |

### 9.2 数据同步策略
采用"本地优先"架构：
```
用户操作
    ↓
写入本地存储
    ↓
显示即时反馈
    ↓
异步同步云端
    ↓
处理冲突（以服务器为准）
```

### 9.3 性能优化策略
| 场景 | 优化方案 |
|------|----------|
| 地图渲染 | 按可视区域加载 |
| POI加载 | 500米范围预加载 |
| 排行榜 | 5分钟缓存 |
| 消息历史 | 分页加载 |

---

## 10. 附录

### 10.1 术语表
| 术语 | 定义 |
|------|------|
| POI | Point of Interest，兴趣点/地标 |
| LBS | Location-Based Service，基于位置的服务 |
| 地理围栏 | 虚拟地理边界，触发位置事件 |
| PTT | Push to Talk，一键通话 |
| EventBus | 事件总线，发布-订阅模式 |
| F2P | Free to Play，免费游戏模式 |
| IAP | In-App Purchase，应用内购买 |

### 10.2 参考游戏
| 游戏 | 参考要素 |
|------|----------|
| Pokemon GO | LBS探索、POI发现 |
| 饥荒 | 生存体征、资源管理 |
| 部落冲突 | 领地建设、资源循环 |
| 我的世界 | 建造系统、沙盒玩法 |

### 10.3 代码文件对照
| 系统 | 核心文件 |
|------|----------|
| 认证 | AuthManager.swift |
| 定位 | LocationManager.swift |
| 领地 | TerritoryManager.swift |
| POI | POIManager.swift |
| 探索 | ExplorationManager.swift |
| 背包 | ItemManager.swift |
| 建造 | BuildingManager.swift |
| 交易 | TradeManager.swift |
| 通讯 | RadioManager.swift, CommunicationManager.swift |
| 频道 | ChannelManager.swift |
| 支付 | StoreKitManager.swift |
| 排行 | LeaderboardManager.swift |
| 成就 | AchievementManager.swift |
| 体征 | VitalSignsManagerV2.swift |

---

**文档维护者：** Game Design Team
**最后更新：** 2025-12-23
